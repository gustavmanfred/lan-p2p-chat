<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P2P Chat Application</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">
    <h1 class="text-4xl mb-8">P2P Chat Application</h1>
    <textarea id="messageInput" class="border border-gray-300 p-2 w-1/2 mb-2" placeholder="Type your message here..."></textarea>
    <button id="sendMessage" class="bg-blue-500 text-white px-4 py-2 rounded">Send</button>
    <div id="messages" class="mt-4 w-1/2 max-h-60 overflow-y-scroll border border-gray-300 p-2"></div>

    <script>
        // WebRTC and MQTT setup
        const signalingServer = 'wss://your-signaling-server.com'; // Replace with your MQTT signaling server
        const peerConnectionConfig = { iceServers: [ { urls: 'stun:stun.l.google.com:19302' } ] };
        let localStream;
        let peerConnection;
        let mqttClient;

        function init() {
            // Initialize WebRTC and MQTT
            mqttClient = mqtt.connect(signalingServer);
            mqttClient.on('connect', () => {
                console.log('Connected to signaling server');
            });
            mqttClient.subscribe('chat/messages');
            mqttClient.on('message', (topic, message) => {
                if (topic === 'chat/messages') {
                    displayMessage(message.toString());
                }
            });

            navigator.mediaDevices.getUserMedia({ video: false, audio: true }).then(stream => {
                localStream = stream;
            });
        }

        function sendMessage() {
            const message = document.getElementById('messageInput').value;
            mqttClient.publish('chat/messages', message);
            displayMessage(message);
            document.getElementById('messageInput').value = '';
        }

        function displayMessage(message) {
            const messagesDiv = document.getElementById('messages');
            messagesDiv.innerHTML += `<div>${message}</div>`;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        document.getElementById('sendMessage').addEventListener('click', sendMessage);
        window.addEventListener('load', init);
    </script>
</body>
</html>